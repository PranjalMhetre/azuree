{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function fileToBase64(file){return new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=()=>{const base64=reader.result.split(\",\")[1];resolve(base64);};reader.onerror=err=>reject(err);reader.readAsDataURL(file);});}export default function App(){const[photoFile,setPhotoFile]=useState(null);const[desc,setDesc]=useState(\"\");const[entries,setEntries]=useState([]);const[loading,setLoading]=useState(false);const upload=async()=>{if(!photoFile)return alert(\"Choose a photo first.\");setLoading(true);try{const base64=await fileToBase64(photoFile);navigator.geolocation.getCurrentPosition(async pos=>{const payload={description:desc,lat:pos.coords.latitude,lon:pos.coords.longitude,filename:photoFile.name,data:base64};const res=await fetch(\"/api/upload\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(payload)});const data=await res.json();if(!res.ok)throw new Error((data===null||data===void 0?void 0:data.message)||JSON.stringify(data));alert(\"Uploaded! URL: \"+data.photo_url);setDesc(\"\");setPhotoFile(null);fetchEntries();},err=>{setLoading(false);alert(\"Location error: \"+err.message);},{enableHighAccuracy:true,timeout:10000});}catch(e){setLoading(false);alert(\"Upload error: \"+e.message);}};const fetchEntries=async()=>{try{const res=await fetch(\"/api/list\");const data=await res.json();setEntries(data);}catch(e){console.error(e);}finally{setLoading(false);}};useEffect(()=>{fetchEntries();},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:800,margin:\"20px auto\",padding:20},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Cloud Diary\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:12},children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>setPhotoFile(e.target.files[0])})}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:12},children:/*#__PURE__*/_jsx(\"input\",{style:{width:\"100%\",padding:8},placeholder:\"Description\",value:desc,onChange:e=>setDesc(e.target.value)})}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:20},children:/*#__PURE__*/_jsx(\"button\",{onClick:upload,disabled:loading,children:loading?\"Uploading...\":\"Upload Entry\"})}),/*#__PURE__*/_jsx(\"h2\",{children:\"Entries\"}),entries.length===0&&/*#__PURE__*/_jsx(\"div\",{children:\"No entries yet.\"}),/*#__PURE__*/_jsx(\"div\",{children:entries.map((e,i)=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:18,padding:12,border:\"1px solid #ddd\",borderRadius:8},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,marginBottom:8},children:e.Description}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:8},children:/*#__PURE__*/_jsx(\"img\",{src:e.PhotoURL,alt:\"\",style:{maxWidth:\"100%\",borderRadius:6}})}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,color:\"#555\"},children:[new Date(e.Timestamp).toLocaleString(),\" \\u2014\",\" \",e.Latitude&&e.Longitude?/*#__PURE__*/_jsx(\"a\",{href:\"https://www.google.com/maps/search/?api=1&query=\".concat(e.Latitude,\",\").concat(e.Longitude),target:\"_blank\",rel:\"noreferrer\",children:\"View on map\"}):\"No location\"]})]},i))})]});}","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","fileToBase64","file","Promise","resolve","reject","reader","FileReader","onload","base64","result","split","onerror","err","readAsDataURL","App","photoFile","setPhotoFile","desc","setDesc","entries","setEntries","loading","setLoading","upload","alert","navigator","geolocation","getCurrentPosition","pos","payload","description","lat","coords","latitude","lon","longitude","filename","name","data","res","fetch","method","headers","body","JSON","stringify","json","ok","Error","message","photo_url","fetchEntries","enableHighAccuracy","timeout","e","console","error","style","maxWidth","margin","padding","children","marginBottom","type","accept","onChange","target","files","width","placeholder","value","onClick","disabled","length","map","i","border","borderRadius","fontSize","Description","src","PhotoURL","alt","color","Date","Timestamp","toLocaleString","Latitude","Longitude","href","concat","rel"],"sources":["/workspaces/azuree/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\n\nfunction fileToBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => {\n      const base64 = reader.result.split(\",\")[1];\n      resolve(base64);\n    };\n    reader.onerror = (err) => reject(err);\n    reader.readAsDataURL(file);\n  });\n}\n\nexport default function App() {\n  const [photoFile, setPhotoFile] = useState(null);\n  const [desc, setDesc] = useState(\"\");\n  const [entries, setEntries] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  const upload = async () => {\n    if (!photoFile) return alert(\"Choose a photo first.\");\n    setLoading(true);\n    try {\n      const base64 = await fileToBase64(photoFile);\n      navigator.geolocation.getCurrentPosition(\n        async (pos) => {\n          const payload = {\n            description: desc,\n            lat: pos.coords.latitude,\n            lon: pos.coords.longitude,\n            filename: photoFile.name,\n            data: base64\n          };\n          const res = await fetch(\"/api/upload\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify(payload)\n          });\n          const data = await res.json();\n          if (!res.ok) throw new Error(data?.message || JSON.stringify(data));\n          alert(\"Uploaded! URL: \" + data.photo_url);\n          setDesc(\"\");\n          setPhotoFile(null);\n          fetchEntries();\n        },\n        (err) => {\n          setLoading(false);\n          alert(\"Location error: \" + err.message);\n        },\n        { enableHighAccuracy: true, timeout: 10000 }\n      );\n    } catch (e) {\n      setLoading(false);\n      alert(\"Upload error: \" + e.message);\n    }\n  };\n\n  const fetchEntries = async () => {\n    try {\n      const res = await fetch(\"/api/list\");\n      const data = await res.json();\n      setEntries(data);\n    } catch (e) {\n      console.error(e);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchEntries();\n  }, []);\n\n  return (\n    <div style={{ maxWidth: 800, margin: \"20px auto\", padding: 20 }}>\n      <h1>Cloud Diary</h1>\n\n      <div style={{ marginBottom: 12 }}>\n        <input\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={(e) => setPhotoFile(e.target.files[0])}\n        />\n      </div>\n\n      <div style={{ marginBottom: 12 }}>\n        <input\n          style={{ width: \"100%\", padding: 8 }}\n          placeholder=\"Description\"\n          value={desc}\n          onChange={(e) => setDesc(e.target.value)}\n        />\n      </div>\n\n      <div style={{ marginBottom: 20 }}>\n        <button onClick={upload} disabled={loading}>\n          {loading ? \"Uploading...\" : \"Upload Entry\"}\n        </button>\n      </div>\n\n      <h2>Entries</h2>\n      {entries.length === 0 && <div>No entries yet.</div>}\n      <div>\n        {entries.map((e, i) => (\n          <div key={i} style={{ marginBottom: 18, padding: 12, border: \"1px solid #ddd\", borderRadius: 8 }}>\n            <div style={{ fontSize: 14, marginBottom: 8 }}>{e.Description}</div>\n            <div style={{ marginBottom: 8 }}>\n              <img src={e.PhotoURL} alt=\"\" style={{ maxWidth: \"100%\", borderRadius: 6 }} />\n            </div>\n            <div style={{ fontSize: 12, color: \"#555\" }}>\n              {new Date(e.Timestamp).toLocaleString()} â€”{\" \"}\n              {e.Latitude && e.Longitude ? (\n                <a href={`https://www.google.com/maps/search/?api=1&query=${e.Latitude},${e.Longitude}`} target=\"_blank\" rel=\"noreferrer\">\n                  View on map\n                </a>\n              ) : (\n                \"No location\"\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}